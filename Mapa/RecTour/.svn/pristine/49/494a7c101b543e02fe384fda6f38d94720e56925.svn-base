package mobi.rectour.web;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;

public class ConexaoAndroidIceCreamGet implements IConexaoWeb{

	private String url ;
	
	public ConexaoAndroidIceCreamGet(String url){
			this.url = url;
	}

	public String buscarServidor() {
		
		String singleLine = "";
		    
		try {
		     	HttpClient httpclient = new DefaultHttpClient();
		    	HttpResponse response = httpclient.execute(new HttpGet(url));
		       
		        BufferedReader reader = new BufferedReader(new InputStreamReader( response.getEntity().getContent(),"UTF-8"));
		        StringBuilder content = new StringBuilder();
		        while ((singleLine = reader.readLine()) != null)
					content.append(singleLine);
	
				reader.close();
				singleLine = content.toString();
		     } catch (Exception e) {
		    	
		    	e.printStackTrace();
		    	singleLine = getErro(e.getMessage());
		    }
		
		return singleLine;
		
	}

	@Override
	public String getErro(String erro) {
		
		return String.format("{\"InformacaoServidor\": {\"Erro\": true," +
										  "\"MsgErroServer\": \"%s\"," +
										  "\"MsgUsuario\": \"Erro ao tentar conectar\"," +
										  "\"MsgVersaoApp\":\"\"," +
										  "\"TituloMsgUsuario\":\"Atenção\"}}",erro);
	}

	@Override
	public InformacoesServidor verificarObjRespostaServidorRetorno(String informacoesSevidor) {
		/*JSONObject jsonObject ;
		JSONObject jsonInfoServidor = new JSONObject();
		try {
			jsonObject = new JSONObject(informacoesSevidor);
			jsonInfoServidor = jsonObject.getJSONObject("success");
			
			
		} catch (JSONException e) {
			
			e.printStackTrace();
		}*/

		
		return new InformacoesServidor(informacoesSevidor);
	}
	
	
	private List<NameValuePair> getParam(){
		
		List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
        
		
		nameValuePairs.add(new BasicNameValuePair("grant_type","client_credentials"));
		
		nameValuePairs.add(new BasicNameValuePair("client_id","TradutorTextosRecTour"));
		
		nameValuePairs.add(new BasicNameValuePair("client_secret","9yjD7eGbpaHJuC2rPyXNPCEwr8sOcnSut9g3bl7BWOo="));
		
		nameValuePairs.add(new BasicNameValuePair("scope","http://api.microsofttranslator.com"));
	
		
		return nameValuePairs;
	}

}
